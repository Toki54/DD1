{% extends 'base.html.twig' %}

{% block title %}Souscription
{% endblock %}

{% block body %}
	{% block stylesheets %}
		<link rel="stylesheet" href="{{ asset('css/abo.css') }}">
	{% endblock %}

	<h1>Souscrire à un abonnement</h1>

	<div
		class="subscription-cards">
		<!-- Carte pour 1 semaine -->
		<div class="subscription-card" data-plan="basic" onclick="selectPlan('1 semaine - 5 €')">
			<div class="card-header">
				<h3>1 Semaine</h3>
				<p class="price">5 €</p>
			</div>
			<p class="description">Accès complet pendant 7 jours</p>
			<button class="btn btn-primary" type="button">Choisir</button>
		</div>

		<!-- Carte pour 1 mois -->
		<div class="subscription-card" data-plan="premium" onclick="selectPlan('1 mois - 15 €')">
			<div class="card-header">
				<h3>1 Mois</h3>
				<p class="price">15 €</p>
			</div>
			<p class="description">Accès complet pendant 1 mois</p>
			<button class="btn btn-primary" type="button">Choisir</button>
		</div>

		<!-- Carte pour 3 mois -->
		<div class="subscription-card" data-plan="vip" onclick="selectPlan('3 mois - 30 €')">
			<div class="card-header">
				<h3>3 Mois</h3>
				<p class="price">30 €</p>
			</div>
			<p class="description">Accès complet pendant 3 mois</p>
			<button class="btn btn-primary" type="button">Choisir</button>
		</div>

		<!-- Carte pour 6 mois -->
		<div class="subscription-card" data-plan="vip" onclick="selectPlan('6 mois - 50 €')">
			<div class="card-header">
				<h3>6 Mois</h3>
				<p class="price">50 €</p>
			</div>
			<p class="description">Accès complet pendant 6 mois</p>
			<button class="btn btn-primary" type="button">Choisir</button>
		</div>

		<!-- Carte pour 1 an -->
		<div class="subscription-card" data-plan="vip" onclick="selectPlan('1 an - 80 €')">
			<div class="card-header">
				<h3>1 An</h3>
				<p class="price">80 €</p>
			</div>
			<p class="description">Accès complet pendant 1 an</p>
			<button class="btn btn-primary" type="button">Choisir</button>
		</div>
	</div>

	<!-- Résumé dynamique -->
	<div id="subscription-summary">
		<h3>Résumé de l'abonnement</h3>
		<p>
			<strong>Abonnement sélectionné :</strong>
			<span id="plan-name">Aucun</span>
		</p>
		<p>
			<strong>Durée :</strong>
			<span id="plan-duration">Aucune</span>
		</p>
		<p>
			<strong>Prix :</strong>
			<span id="plan-price">0 €</span>
		</p>
	</div>

	<div class="form-container">
		{{ form_start(form) }}

		{{ form_row(form.plan) }}
		{{ form_row(form.startDate) }}
		{{ form_row(form.endDate) }}

		<button type="submit" class="btn btn-submit">Souscrire</button>

		{{ form_end(form) }}
	</div>

	 <script>
	    // Fonction pour mettre à jour le résumé et sélectionner le plan
	    function selectPlan(plan) {
	        const planName = document.getElementById('plan-name');
	        const planDuration = document.getElementById('plan-duration');
	        const planPrice = document.getElementById('plan-price');
	
	        const plans = {
	            '1 semaine - 5 €': { duration: '1 semaine', price: '5 €' },
	            '1 mois - 15 €': { duration: '1 mois', price: '15 €' },
	            '3 mois - 30 €': { duration: '3 mois', price: '30 €' },
	            '6 mois - 50 €': { duration: '6 mois', price: '50 €' },
	            '1 an - 80 €': { duration: '1 an', price: '80 €' },
	        };
	
	        if (plans[plan]) {
	            planName.textContent = plan;
	            planDuration.textContent = plans[plan].duration;
	            planPrice.textContent = plans[plan].price;
	
	            const planField = document.querySelector('input[name="subscription[plan]"]');
	            planField.value = plan;
	
	            // Visuel sélection carte
	            document.querySelectorAll('.subscription-card').forEach(card => {
	                card.classList.remove('selected');
	            });
	            const selectedCard = Array.from(document.querySelectorAll('.subscription-card')).find(card => card.textContent.includes(plan));
	            if(selectedCard) selectedCard.classList.add('selected');
	        }
	    }
	</script>

{% endblock %}

