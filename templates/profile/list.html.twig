{% extends 'base.html.twig' %}

{% block title %}Liste des Profils
{% endblock %}

{% block body %}
	{% block stylesheet %}
		<link rel="stylesheet" href="{{ asset('css/list.css') }}">
	{% endblock %}

	<section
		class="container">
		<!-- Bloc de tri (Filtre) -->
		<article class="sort-container">
			<header class="sort-header">
				<button class="toggle-sort-btn">Filtrer les profils</button>
			</header>
			<section class="sort-content">
				<form method="GET" action="{{ path('app_profiles_list') }}" class="sort-form">
					<div>
						<label for="sex">Sexe:</label>
						<input type="checkbox" name="sex" value="male" {% if sex == 'male' %} checked {% endif %}>
						Homme
						<input type="checkbox" name="sex" value="female" {% if sex == 'female' %} checked {% endif %}>
						Femme
					</div>
					<div>
						<label for="situation">Situation:</label>
						<input type="checkbox" name="situation" value="Celibataire" {% if situation == 'Celibataire' %} checked {% endif %}>
						Célibataire
						<input type="checkbox" name="situation" value="En couple" {% if situation == 'En couple' %} checked {% endif %}>
						En couple
					</div>
					<button type="submit">Appliquer le tri</button>
				</form>
			</section>
		</article>

		<!-- Liste des profils -->
		<section class="profile-container">
			{% for profile in profiles %}
				<article
					class="profile-card">
					<!-- Avatar -->
					<section class="avatar-container">
						<img src="{{ asset(profile.avatar ? 'uploads/avatars/' ~ profile.avatar : 'images/default-avatar.png') }}" alt="Avatar">
					</section>

					<!-- Informations -->
					<section class="info-container">
						<h2>{{ profile.user.pseudo }}</h2>
						<p>
							<strong>Sexe:</strong>
							{{ profile.sex|default('Non spécifié') }}</p>
						<p>
							<strong>Situation:</strong>
							{{ profile.situation|default('Non renseigné') }}</p>
						<p>
							<strong>Je recherche:</strong>
							{{ profile.research|default('Non spécifié') }}</p>
						<p>
							<strong>Biographie:</strong>
							{{ profile.biography|default('Aucune biographie') }}</p>
						<p>
							<strong>Département:</strong>
							{{ profile.department|default('Non spécifié') }}</p>
						<p>
							<strong>Ville:</strong>
							{{ profile.city|default('Non spécifiée') }}</p>

						<!-- Bouton pour afficher/masquer les photos -->
						<button class="toggle-photos-btn" data-profile-id="{{ profile.id }}">Afficher les photos</button>

						<a href="{{ path('app_message_create', {'id': profile.user.id}) }}" class="btn btn-primary">Envoyer un message</a>
						<a href="{{ path('app_message_create', {'id': profile.user.id, 'chatRequest': 1}) }}" class="btn btn-warning">Demander une discussion</a>
					</section>

					<!-- Galerie de photos -->
					<section class="photo-gallery" id="gallery-{{ profile.id }}" style="display: none;">
						{% if profile.photos %}
							{% for photo in profile.photos %}
								<img src="{{ asset('uploads/photos/' ~ photo) }}" alt="Photo" class="photo-thumbnail" data-bs-toggle="modal" data-bs-target="#photoCarousel" data-bs-slide-to="{{ loop.index0 }}">
							{% endfor %}
						{% else %}
							<p>Aucune photo ajoutée.</p>
						{% endif %}
					</section>
				</article>
			{% endfor %}
		</section>
	</section>

	 <script src="{{ asset('script/js/profile-list.js') }}" defer></script>

{% endblock %}

